{% extends "base.html" %}
{% load staticfiles %}

{% block title %} Move - {{ move.name }}{% endblock %}
{% block header %} Move: {{ move.name }}{% endblock %}
{% block content %}
{{ move.name }} is comprised of the following components:
<br />
<ul class="footbag_sequence">
    {% for comp in sequence %}
    <li><a href="{% url "component_detail" comp.component.slug %}"> {{comp.component.name}}</a> </li>
    {% endfor %}
</ul>

{% if load_youtube %}
<script src="{% static 'js/load_youtube.js' %}"></script>
{% endif %}

<div id="player"></div>

<br />
<br />
<div class="demonstration_videos">
{% with videos=video_demo.all %}
    {% if videos %}
        Video demonstration:<br />
        <ul>
        {% for vid in videos %}
            {% if vid.video_type == vid_type_external %}
                <li><a href="{{ vid.URL }}" class="vidtype{{ vid.video_type }}"> click for demonstration (external link)</a></li>
            {% else %}
                <li><a href="{{ vid.URL }}" class="vidtype{{ vid.video_type }}"> click for demonstration </a></li>
            {% endif %}
        {% endfor %}
        </ul>
    {% else %}
        No video demonstrations found.
    {% endif %}
{% endwith %}
</div>

<br />
<div class="tutorial_videos">
{% with videos=video_tutorial.all %}
    {% if videos %}
        Tutorial video:<br />
        <ul>
        {% for vid in videos %}
            {% if vid.video_type == vid_type_external %}
                <li><a href="{{ vid.URL }}" class="vidtype{{ vid.video_type }}"> click for tutorial (external link)</a></li>
            {% else %}
                <li><a href="{{ vid.URL }}" class="vidtype{{ vid.video_type }}"> click for tutorial </a></li>
            {% endif %}
        {% endfor %}
        </ul>
    {% else %}
        No video tutorials found.
    {% endif %}
{% endwith %}
</div>


{% if load_youtube %}
<script>
load_first_video = function(){
    //first Youtube video to be loaded in the player along with the page
    player.loadVideoById({
        videoId: "{{ first_yt_id }}",
    {% if first_yt_video.use_start %}
        startSeconds: {{first_yt_video.start_time}},
    {% endif %}
    {% if first_yt_video.use_end %}
        endSeconds: {{first_yt_video.end_time}},
    {% endif %}
    });
}

//Get all the demo/tutorial links that contain a youtube video
var yt_vid_class = document.getElementsByClassName("vidtype{{vid_types.Youtube}}");

//Function that's called whenever a youtube video link is clicked
var ytVidFunction = function(evt) {
    var attribute = this.getAttribute("href");
    player.loadVideoById(extractYouTubeID(attribute));
    cancelDefaultAction(evt);
};

//Register listener for each youtube link
for(var i=0;i<yt_vid_class.length;i++){
    yt_vid_class[i].addEventListener('click', ytVidFunction, false);
}
</script>
{% endif %}

{% endblock %}
