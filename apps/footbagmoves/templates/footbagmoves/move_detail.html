{% extends "base.html" %}
{% load staticfiles %}

{% block title %} Move - {{ move.name }}{% endblock %}
{% block header %} Move: {{ move.name }}{% endblock %}
{% block content %}
{{ move.name }} is comprised of the following components:
<br />
<ul class="footbag_sequence">
    {% for comp in sequence %}
    <li><a href="{% url "component_detail" comp.component.slug %}"> {{comp.component.name}}</a> </li>
    {% endfor %}
</ul>

{% if load_youtube %}
<script src="{% static 'js/load_youtube.js' %}"></script>
{% endif %}

<div id="player"></div>

{% if load_youtube %}
<script>
var player;
youtube_ready = function(){
    //Youtube ID of the first video to be loaded in the player along with the page
    var first_vid_id = "{{ first_yt_id }}";
    player = new YT.Player('player', {
        height: '390',
        width: '640',
        videoId: first_vid_id,
        events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
        }
    });
}

</script>
{% endif %}

<br />
<br />
<div class="demonstration_videos">
{% with videos=video_demo.all %}
    {% if videos %}
        Video demonstration:<br />
        {% for vid in videos %}
            <a href="{{ vid.URL }}" class="vidtype{{ vid.video_type }}"> click for demo </a>
        {% endfor %}
    {% else %}
        No video demonstrations found.
    {% endif %}
{% endwith %}
</div>

<br />
<div class="tutorial_videos">
{% with videos=video_tutorial.all %}
    {% if videos %}
        Tutorial video:<br />
        {% for vid in videos %}
            <a href="{{ vid.URL }}" class="vidtype{{ vid.video_type }}"> click for tutorial </a>
        {% endfor %}
    {% else %}
        No video tutorials found.
    {% endif %}
{% endwith %}
</div>

<script>
//A function to prevent the default behaviour of an event,
//used to prevent href from being followed when we are updating a video in the player
function cancelDefaultAction(e) {
    var evt = e ? e:window.event;
    if (evt.preventDefault) evt.preventDefault();
    evt.returnValue = false;
    return false;
}

//Get all the demo/tutorial links that contain a youtube video
var yt_vid_class = document.getElementsByClassName("vidtype{{yt_vid_type}}");

//Function that's called whenever a youtube video link is clicked
var ytVidFunction = function(evt) {
    var attribute = this.getAttribute("href");
    alert(attribute);
    cancelDefaultAction(evt)
};

for(var i=0;i<yt_vid_class.length;i++){
    yt_vid_class[i].addEventListener('click', ytVidFunction, false);
}
</script>
{% endblock %}